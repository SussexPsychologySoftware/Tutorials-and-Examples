# Digital Triggers
Digital triggers are a recording of when something happened in your experiment - for example the exact moment a stimulus was shown on the screen. We can never know exactly when something happened for a variety of reasons - including the fact that your computer might just be busy doing something else the moment our stimulus was shown, which then leads the computer to record the stimulus being shown slightly later than it actually was. This can have knock on effects when it comes to data analysis, for example when we are trying to line up the changes in someone's EEG signals (which are measured several thousands of times a second) with the moment a new stimulus was shown. Therefore, we can use a few tricks to try to get our recording of stimulus onset to be as accurate as possible.

## Experimental Setup
Typical setups where you will need Digital Triggers might have 1 or 2 computers, a recording device, and a few cables. The recording device might be an EEG cap/headset or skin-conductance or ECG electrodes (e.g. with a Biopac product). Researchers will often use two computers in the interest of freeing up each computer's resources to be as accurate as possible - one computer records the physiology data, whilst the other displays the stimulus and records participant interactions (e.g. keyboard presses and mouse clicks). For example, the first computer might be running AcqKnowledge Biopac recording software and the second computer might run Psychopy, Inquisit, or E-Prime, etc. In such a case, we need to get information on the status of the experiment (e.g., onset and offset time of the stimulus; beginning and end of block, trial, or experiment) to the computer making the physiology recordings. In order to line up the information on the status of the experiment and the physiology recordings as closely as possible, the information on the status of the experiment is usually passed through the physiology recording equipment hardware, so it can all be delivered to the computer recording the physiology data at the same time.

## Serial/ Parallel Ports
To send such information between computers, psychologists traditionally used the serial (https://en.wikipedia.org/wiki/Serial_port) or parallel ports (https://en.wikipedia.org/wiki/Parallel_port) that used to be found on the back of computers in order to connect them to printers (amongst other things). Even if your current setup is transferring the information from your computer over USB or wirelessly, it is probably mimicking these ports at the software level, and so understanding these ports provides a good example to understand why the software functions the way it does . Moreover the part of the cable that connects to the physiology equipment is often still a parallel port. Parallel Port cables look like this:

### Pins & bits
Notice that there are several pins on the cable - these do different things, as you can see below, but what's relevant are the pins that say 'D0' to 'D7' on the illustration below:


These are the channels we will send triggers through. These pins are the ends of separate wires running through the cable, and information is sent through them by turning them either on (i.e. so that they have electricity running through them) or off (no electricity is running through them). We will tell the computer to turn them on or off by sending them strings of 8 1s or 0s - i.e. to turn lines 1, 2, and 4 on we can send '11010000' down the wire, and the computer will handle the rest for us. We can then (often) send '10000000' to turn 2 and 4 off and keep 1 open (although not always in this order, which we deal with below). Notice, however, we will usually have to send the information for all pins simultaneously (note 'parallel' port).

### Mapping lines to experiment status
So, sending on or off (i.e., 1 or 0) across 8 (sometimes 16) different lines (or 'channels') is the medium we have to send information from our experimental setup. This might seem restrictive but is more than enough for most experimental purposes. A common setup might use line 1 to indicate the start and end of a block or trial, and to use line 2 for the start and end of the presentation of stimulus A, and line 3 for stimulus B, etc.

The image below shows digital triggers being recorded on separate lines by Biopac's AcqKnowledge software (source: https://www.biopac.com/product/stimulation-response-analysis-software-module/):


### Overlapping triggers vs 'Blips'
We might choose to turn lines on at the start of an event and off at the end, and so may have the opening and closing of lines overlapping each-other (e.g. one will remain open whilst others turn on and off). Or, we can choose to turn a line on very briefly and then turn it off again, creating a spike in the recording on this line (referred to as a 'pulse', but I prefer calling it a 'blip') which we can extract at analysis to mark the event, ensuring that the lines turning on and off don't overlap one another. However, if pulsing the wire, there needs to be some small delay (typically 0.001 seconds) for the computer to reliably pick up this brief change, which is handled by pausing the execution of the entire program for that duration.

## Encoding triggers
Most software you use to send and receive these triggers won't ask for or send back a binary series of 8 1's or 0's but instead use numbers in one of several formats. For example, Cedrus' Pyxid package (https://github.com/cedrus-opensource/pyxid) does allows you to use the line numbers you wish to open or close, whilst the more common pySerial package (https://pyserial.readthedocs.io/en/latest/) used by PsychoPy (https://psychopy.org/hardware/serialPortInstr.html) is often controlled using 'Hex codes'. The data you receive will also either list the line numbers opened and closed, or an actual number which encodes them. To cover all bases (pun intended), the following section is a little involved (but hopefully interesting) and can be skipped by most readers.

### Base-10
Starting at the beginning, we usually count in what's called 'base-10', which means we use numbers 0-9, and progressively store groups of 10 on the left hand digit (https://en.wikipedia.org/wiki/Decimal). For example, after 9 we go to 10, storing one lot of 10 in the '1', and starting the counting back at 0 on the right hand digit. To add 1 to 99, as both digits are already at the maximum value of 9, we flip them to 0 and add a 1 on the left to store the 10 lots of 10 we have. Interesting there isn't anything actually more natural about base-10 counting, and some cultures have used base-12 (i.e. they had 12 separate symbols for 0-11) or even base-60 counting, which is why clocks aren't 'metric' but in groups of 60 seconds and minutes, 12 hours, etc. 

### Binary
Computers also don't 'think' in 0-9, but in 1's and 0's - which we call 'binary', or 'base-2' counting. However, the counting proceeds the same, counting to the highest number available (just a 1 instead of a 9), storing that number on the left, and adding another digit to the right (see: https://www.mathsisfun.com/binary-number-system.html). So we proceed as follows: 0, 1, 10, 11, 100, 101, 110, 111. Note that what we've just done is counted from 0-7 in binary; in this system '101' doesn't mean 'one hundred and one', it stands for the number 5 (imagine we were using symbols other than 1 and 0 if that makes things easier). Note then that when we send '1000 0000' or '0100 0000' across our cable to activate lines 1 or 2 respectively, this can also be encoded as an actual number (128 or 64 in the previous examples when you remove the 0's on the left hand side). These are the sort of numbers you might find in your data after sending triggers across.

### Hex
So we can count up to 8 different digits (numbers 0-7) using 3 'bits' (spaces for 0s or 1s), and 16 numbers can be represented with 4 bits, then 32, 64, 128, etc - and you might have noticed these numbers come up quite frequently when dealing with computers. For this reason, computers use another number system to store numbers in a more compressed manner than binary - base-16, which is called 'Hexadecimal' or 'hex' (https://en.wikipedia.org/wiki/Hexadecimal). Hex counting uses the numbers 0-9 and then A-F for numbers 10-15. This can get confusing, e.g. if F=15 then 10=16, and FF=255 (play around with https://www.rapidtables.com/convert/number/hex-to-decimal.html?x=FF). However, this is a common format for sending triggers with PsychoPy using e.g. `port.write('F1'.encode())`.